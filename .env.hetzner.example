# ConnectGlobal Hetzner Production Environment
# Copy this file to .env.hetzner and configure for your deployment
# ================================================================

# DOMAIN CONFIGURATION
# ====================
DOMAIN_NAME=yourdomain.com
MAIL_HOSTNAME=mail.yourdomain.com
FRONTEND_URL=https://yourdomain.com

# DATABASE CONFIGURATION (PostgreSQL Production)
# ==============================================
POSTGRES_DB=connectglobal_prod
POSTGRES_USER=connectglobal_user
POSTGRES_PASSWORD=REPLACE_WITH_SUPER_SECURE_DATABASE_PASSWORD_32_CHARS_MIN

# REDIS CONFIGURATION (Production Cache)
# ======================================
REDIS_PASSWORD=REPLACE_WITH_SECURE_REDIS_PASSWORD_16_CHARS_MIN

# SELF-HOSTED SMTP CONFIGURATION (Your Mail Server)
# =================================================
SELF_HOSTED_SMTP=true
SMTP_PASSWORD=REPLACE_WITH_SECURE_EMAIL_PASSWORD_FOR_NOREPLY_ACCOUNT

# JWT SECURITY (CRITICAL - Generate with crypto.randomBytes(64).toString('hex'))
# ==============================================================================
JWT_SECRET=REPLACE_WITH_256_BIT_RANDOM_HEX_KEY_GENERATED_VIA_CRYPTO_RANDOMBYTES

# GRAFANA MONITORING (Optional)
# =============================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=REPLACE_WITH_SECURE_GRAFANA_PASSWORD

# BACKUP CONFIGURATION
# ===================
BACKUP_RETENTION_DAYS=30

# HETZNER SERVER SETUP COMMANDS
# =============================
# Run these commands on your Hetzner server:
#
# 1. Create directory structure:
#    mkdir -p /opt/connectglobal/{data,state,logs,config,uploads,cache,backups}/{postgres,redis,mail,app,nginx,grafana}
#
# 2. Set permissions:
#    chown -R 1000:1000 /opt/connectglobal/data
#    chown -R 1000:1000 /opt/connectglobal/uploads
#    chown -R 472:472 /opt/connectglobal/data/grafana
#    chmod -R 755 /opt/connectglobal
#
# 3. Copy environment file:
#    cp .env.hetzner.example .env.hetzner
#    nano .env.hetzner  # Configure your values
#
# 4. Generate secure passwords:
#    openssl rand -base64 32  # For database
#    openssl rand -base64 16  # For Redis
#    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"  # For JWT
#
# 5. Setup SSL certificates (before starting containers):
#    certbot certonly --standalone -d yourdomain.com -d www.yourdomain.com
#    certbot certonly --standalone -d mail.yourdomain.com
#
# 6. Start the stack:
#    docker-compose -f docker-compose.hetzner.yml --env-file .env.hetzner up -d
#
# 7. Setup mail accounts:
#    docker exec -it connectglobal-mailserver-prod setup email add noreply@yourdomain.com YOUR_SMTP_PASSWORD
#    docker exec -it connectglobal-mailserver-prod setup email add admin@yourdomain.com ADMIN_PASSWORD
#    docker exec -it connectglobal-mailserver-prod setup email add support@yourdomain.com SUPPORT_PASSWORD
#
# 8. Configure DKIM:
#    docker exec -it connectglobal-mailserver-prod setup config dkim domain yourdomain.com
#    # Add the output as TXT record: mail._domainkey.yourdomain.com
#
# 9. Test the deployment:
#    curl https://yourdomain.com/health
#    docker-compose -f docker-compose.hetzner.yml logs connectglobal-api-prod
#
# 10. Monitor:
#     docker-compose -f docker-compose.hetzner.yml ps
#     docker-compose -f docker-compose.hetzner.yml logs -f

# PRODUCTION CHECKLIST
# ====================
# Before going live, ensure:
# 
# [ ] Domain DNS records are configured:
#     - A: @ → your-server-ip
#     - A: www → your-server-ip  
#     - A: mail → your-server-ip
#     - MX: @ → mail.yourdomain.com (priority 10)
#     - TXT: @ → "v=spf1 mx a ~all"
#     - TXT: _dmarc → "v=DMARC1; p=none; rua=mailto:postmaster@yourdomain.com"
#     - TXT: mail._domainkey → DKIM record (generated by mail server)
#
# [ ] SSL certificates are installed and valid
# [ ] All services start successfully
# [ ] Database is accessible and migrated
# [ ] Mail server can send and receive emails
# [ ] Application health check passes
# [ ] Monitoring is accessible (Grafana)
# [ ] Backups are configured and tested
# [ ] Security scan completed
# [ ] Performance test passed
#
# HETZNER-SPECIFIC OPTIMIZATIONS
# ==============================
# For optimal performance on Hetzner:
#
# 1. Enable IPv6 in Hetzner console
# 2. Configure firewall rules
# 3. Set up monitoring alerts  
# 4. Configure automated backups to Hetzner Storage Box
# 5. Consider load balancer for high traffic
#
# COST ESTIMATE (Hetzner)
# =======================
# - CPX21 (3 vCPU, 8GB RAM): €7.90/month
# - Domain: €10-15/year
# - Storage Box (100GB backup): €3.20/month (optional)
# - Total: ~€11-12/month for unlimited emails and full control
#
# vs. Cloud alternatives: €50-150/month
# You save: 80-90% with self-hosting!